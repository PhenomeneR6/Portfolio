<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Portfolio</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0;}
  body{font-family:Arial, sans-serif;background:#0f0f0f;color:#fff;display:flex;flex-direction:column;align-items:center;min-height:100vh;}
  header{padding:2rem 1rem;text-align:center;}
  nav{display:flex;gap:1rem;margin-bottom:2rem;flex-wrap:wrap;justify-content:center;}
  nav button{background:rgba(0,151,167,0.1);border:none;padding:0.5rem 1rem;border-radius:6px;color:#00acc1;cursor:pointer;transition:0.3s;}
  nav button.active,nav button:hover{background:rgba(0,151,167,0.3);}
  main{width:90%;max-width:1200px;display:flex;flex-direction:column;gap:2rem;}

  section{display:none;flex-direction:column;gap:1rem;align-items:center;width:100%;}
  section.active{display:flex;}

  .card{background:rgba(255,255,255,0.05);padding:1.5rem;border-radius:10px;box-shadow:0 0 15px rgba(0,151,167,0.2);transition:transform 0.3s ease,box-shadow 0.3s ease;display:flex;flex-direction:column;align-items:center;}
  .card:hover{transform:translateY(-5px);box-shadow:0 0 20px rgba(0,151,167,0.4);}

  /* --- WORKS --- */
  .work-categories{display:flex;flex-wrap:wrap;gap:1rem;justify-content:center;width:100%;}
  .work-category{flex:1 1 calc(25% - 1rem);cursor:pointer;font-weight:600;font-size:1.1rem;text-align:center;padding:0.5rem 0;border-radius:6px;background:rgba(0,151,167,0.1);transition:0.3s;display:flex;justify-content:center;align-items:center;}
  .work-category:hover{background:rgba(0,151,167,0.25);transform:scale(1.05);}
  .work-category.active{background:rgba(255,255,255,0.1);}
  .work-items{display:none;flex-wrap:wrap;gap:1rem;justify-content:center;width:100%;margin-top:1rem;}
  .work-items.active{display:flex;}
  .work-items .card{max-width:600px;flex:1 1 250px;}
  .work-items .card h3{text-align:center;margin-bottom:0.5rem;color:#00acc1;}
  .content-wrapper{display:flex;gap:1rem;justify-content:center;align-items:center;flex-wrap:wrap;}

  /* --- EXPERTISE --- */
  #content.expertise{display:grid;grid-template-columns:repeat(2, 1fr);gap:1.5rem;width:100%;align-items:stretch;}
  #content.expertise .card{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;background:rgba(255,255,255,0.05);padding:1.5rem;border-radius:10px;box-shadow:0 0 15px rgba(0,151,167,0.2);transition:transform 0.3s ease, box-shadow 0.3s ease;height:100%;}
  #content.expertise .card h3{margin:0 0 0.5rem 0;color:#00acc1;text-align:center !important;}
  #content.expertise .card p{white-space:pre-line;margin:0;color:#ddd;text-align:left;width:100%;}
  @media (max-width:1000px){#content.expertise{grid-template-columns:1fr;}}

  /* --- VOUCHES --- */
  #content.vouches{display:grid;grid-template-columns:repeat(2, 1fr);gap:1.5rem;text-align:center;width:100%;align-items:stretch;}
  #content.vouches .card{height:100%;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;}
  #content.vouches img{width:60%;height:auto;border-radius:50%;box-shadow:none;margin:0 auto;}
  .vouche-title{color:#00acc1;margin-top:0.5rem;font-weight:600;}
  .vouche-text{text-align:justify;margin-top:0.5rem;color:#ddd;}
  @media (max-width:1000px){#content.vouches{grid-template-columns:1fr;}}

  /* --- LIGHTBOX --- */
  #lightbox{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:none;align-items:center;justify-content:center;z-index:1000;}
  #lightbox img{max-width:90%;max-height:90%;object-fit:contain;}
  #lightbox .close-btn{position:absolute;top:20px;right:30px;font-size:2rem;color:#fff;cursor:pointer;}
</style>
</head>
<body>
  <header>
    <h1>Portfolio</h1>
  </header>

  <nav>
    <button class="active" data-section="bio">Bio</button>
    <button data-section="experience">Experience</button>
    <button data-section="works">Works</button>
    <button data-section="expertise">Expertise</button>
    <button data-section="vouches">Vouches</button>
    <button data-section="contact">Contact</button>
  </nav>

  <main>
    <section id="bio" class="active"></section>
    <section id="experience"></section>
    <section id="works"></section>
    <section id="expertise"></section>
    <section id="vouches"></section>
    <section id="contact"></section>
  </main>

  <div id="lightbox"><span class="close-btn">&times;</span><img src="" alt=""></div>

<script>
async function loadData(){
  const res=await fetch('data.json');
  const data=await res.json();
  renderSection('bio', data);
  renderSection('experience', data);
  renderWorks(data);
  renderSection('expertise', data);
  renderSection('vouches', data);
  renderSection('contact', data);
}

function renderWorks(data){
  const section=document.getElementById('works');
  const catContainer=document.createElement('div');
  catContainer.className='work-categories';
  const itemsContainer=document.createElement('div');
  itemsContainer.className='work-items-container';

  data.work.forEach((cat, index)=>{
    const catDiv=document.createElement('div');
    catDiv.className='work-category';
    catDiv.textContent=cat.category;
    if(index===0)catDiv.classList.add('active');

    const itemsDiv=document.createElement('div');
    itemsDiv.className='work-items';
    if(index===0)itemsDiv.classList.add('active');

    cat.items.forEach(el=>{
      const card=document.createElement('div');
      card.className='card';

      if(el.title){
        const h3=document.createElement('h3');
        h3.textContent=el.title;
        card.appendChild(h3);
      }

      const contentWrapper=document.createElement('div');
      contentWrapper.className='content-wrapper '+((el.image||el.images)&&el.text?"row":"col");

      // ✅ Multi-images en grille 2 colonnes sans gros gap
      if(el.images && Array.isArray(el.images)){
        const imgGroup=document.createElement("div");

        if(el.images.length > 1){
          imgGroup.style.display = "grid";
          imgGroup.style.gridTemplateColumns = "repeat(2, 1fr)";
          imgGroup.style.gap = "0.5rem";
          imgGroup.style.width = "100%";
          imgGroup.style.justifyItems = "center";
        } else {
          imgGroup.style.display = "flex";
          imgGroup.style.justifyContent = "center";
        }

        el.images.forEach(src=>{
          const img=document.createElement("img");
          img.src=src;
          img.style.width="100%";
          img.style.maxWidth="250px";
          img.style.height="auto";
          img.style.borderRadius="8px";
          img.style.cursor="zoom-in";
          img.addEventListener("click",()=>openLightbox(src));
          imgGroup.appendChild(img);
        });
        contentWrapper.appendChild(imgGroup);

      } else if(el.image){
        const img=document.createElement("img");
        img.src=el.image;
        img.style.width="250px";
        img.style.height="auto";
        img.style.borderRadius="8px";
        img.style.cursor="zoom-in";
        img.style.marginRight="1rem";
        img.addEventListener("click",()=>openLightbox(el.image));
        contentWrapper.appendChild(img);
      }

      if(el.text){
        const p=document.createElement("p");
        p.textContent=el.text;
        p.style.whiteSpace="pre-line";
        p.style.flex="1";
        contentWrapper.appendChild(p);
      }

      card.appendChild(contentWrapper);
      itemsDiv.appendChild(card);
    });

    catDiv.addEventListener("click",()=>{
      document.querySelectorAll(".work-category").forEach(c=>c.classList.remove("active"));
      document.querySelectorAll(".work-items").forEach(i=>i.classList.remove("active"));
      catDiv.classList.add("active");
      itemsDiv.classList.add("active");
    });

    catContainer.appendChild(catDiv);
    itemsContainer.appendChild(itemsDiv);
  });

  section.appendChild(catContainer);
  section.appendChild(itemsContainer);
}

function renderSection(section,data){
  const content=document.getElementById(section);
  content.innerHTML='';
  if(section==="bio"){
    content.innerHTML=`<div class="card"><p>${data.bio.join("\n\n")}</p></div>`;
    return;
  }

  if (!Array.isArray(data[section])) return;

  data[section].forEach(item=>{
    const card=document.createElement("div");
    card.className="card";

    if(section==="vouches" && item.image){
      card.innerHTML=`
        ${item.image?`<img src="${item.image}" alt="${item.title||''}">`:""}
        ${item.title?`<h3 class="vouche-title">${item.title}</h3>`:""}
        ${item.text?`<p class="vouche-text">${item.text}</p>`:""}
      `;
    } else if(section==="contact"){
      if(item.type==="link"){
        card.classList.add("clickable");
        card.innerHTML=`<p>${item.label}</p>`;
        card.addEventListener("click",()=>window.open(item.url,"_blank"));
      } else if(item.text){
        card.innerHTML=`<p>${item.text}</p>`;
      } else if(item.title){
        card.innerHTML=`<h3 style="margin:0 0 0.5rem 0; color:#00acc1;">${item.title}</h3>`;
      }
    } else {
      card.innerHTML=`<p>${item}</p>`;
    }
    content.appendChild(card);
  });

  // ✅ égalisation des hauteurs Expertise & Vouches
  if(section==="expertise"||section==="vouches"){
    const equalize = ()=>{
      const cards = content.querySelectorAll('.card');
      let max = 0;
      cards.forEach(c=>{ c.style.height='auto'; max = Math.max(max, c.offsetHeight); });
      cards.forEach(c=>c.style.height=max+'px');
    };
    setTimeout(equalize, 400);
    window.addEventListener('resize', equalize);
  }
}

document.querySelectorAll("nav button").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
    document.getElementById(btn.dataset.section).classList.add("active");
  });
});

function openLightbox(src){
  const lightbox=document.getElementById("lightbox");
  const img=lightbox.querySelector("img");
  img.src=src;
  lightbox.style.display="flex";
}

document.querySelector("#lightbox .close-btn").addEventListener("click",()=>{
  document.getElementById("lightbox").style.display="none";
});

loadData();
</script>
</body>
</html>
